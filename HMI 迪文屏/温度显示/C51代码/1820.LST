C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE 1820
OBJECT MODULE PLACED IN 1820.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE 1820.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1           /*************************´Ë²¿·ÖÎª18B20µÄÇý¶¯³ÌÐò*************************************/
   2          //#pragma SRC
   3          #include <reg52.H>
   4          #include <intrins.h>
   5          #include <stdio.h>
   6          sbit BEEP = P1^4;
   7          unsigned char Decimal;
   8          
   9          #define  NOP()   _nop_()   /* ¶¨Òå¿ÕÖ¸Áî */
  10          #define  _Nop()  _nop_()        */
  11          
  12          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª                   
  13          void TempDelay (unsigned char idata us);
  14          void Init18b20 (void);
  15          void WriteByte (unsigned char idata wr);  //µ¥×Ö½ÚÐ´Èë
  16          void read_bytes (unsigned char idata j);
  17          unsigned char CRC (unsigned char j);
  18          void GemTemp (void);
  19          void Config18b20 (void);
  20          void ReadID (void);
  21          void TemperatuerResult(void);
  22          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
  23          
  24          sbit   D18B20=P3^7;  //ÎÂ¶È´«¸ÐÆ÷
  25          
  26          bit  flag;
  27          unsigned int  idata Temperature;
  28          unsigned char idata temp_buff[9]; //´æ´¢¶ÁÈ¡µÄ×Ö½Ú£¬read scratchpadÎª9×Ö½Ú£¬read rom IDÎª8×Ö½Ú
  29          unsigned char idata id_buff[8];
  30          unsigned char idata *p,TIM;
  31          unsigned char idata crc_data;
  32          
  33          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
  34          unsigned char code CrcTable [256]={
  35          0,  94, 188,  226,  97,  63,  221,  131,  194,  156,  126,  32,  163,  253,  31,  65,
  36          157,  195,  33,  127,  252,  162,  64,  30,  95,  1,  227,  189,  62,  96,  130,  220,
  37          35,  125,  159,  193,  66,  28,  254,  160,  225,  191,  93,  3,  128,  222,  60,  98,
  38          190,  224,  2,  92,  223,  129,  99,  61,  124,  34,  192,  158,  29,  67,  161,  255,
  39          70,  24,  250,  164,  39,  121,  155,  197,  132,  218,  56,  102,  229,  187,  89,  7,
  40          219,  133, 103,  57,  186,  228,  6,  88,  25,  71,  165,  251,  120,  38,  196,  154,
  41          101,  59, 217,  135,  4,  90,  184,  230,  167,  249,  27,  69,  198,  152,  122,  36,
  42          248,  166, 68,  26,  153,  199,  37,  123,  58,  100,  134,  216,  91,  5,  231,  185,
  43          140,  210, 48,  110,  237,  179,  81,  15,  78,  16,  242,  172,  47,  113,  147,  205,
  44          17,  79,  173,  243,  112,  46,  204,  146,  211,  141,  111,  49,  178,  236,  14,  80,
  45          175,  241, 19,  77,  206,  144,  114,  44,  109,  51,  209,  143,  12,  82,  176,  238,
  46          50,  108,  142,  208,  83,  13,  239,  177,  240,  174,  76,  18,  145,  207,  45,  115,
  47          202,  148, 118,  40,  171,  245,  23,  73,  8,  86,  180,  234,  105,  55,  213, 139,
  48          87,  9,  235,  181,  54,  104,  138,  212,  149,  203,  41,  119,  244,  170,  72,  22,
  49          233,  183,  85,  11,  136,  214,  52,  106,  43,  117,  151,  201,  74,  20,  246,  168,
  50          116,  42,  200,  150,  21,  75,  169,  247,  182,  232,  10,  84,  215,  137,  107,  53}; 
  51          
  52          
C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 2   

  53          
  54          
  55          
  56          
  57          //
  58          /************************************************************
  59          *Function:ÑÓÊ±´¦Àí
  60          *parameter:
  61          *Return:
  62          *Modify:
  63          *************************************************************/
  64          void TempDelay (unsigned char idata us)
  65          {
  66   1              while(us--);
  67   1      }
  68          
  69          /************************************************************
  70          *Function:18B20³õÊ¼»¯
  71          *parameter:
  72          *Return:
  73          *Modify:
  74          *************************************************************/
  75          void Init18b20 (void)
  76          {
  77   1              D18B20=1;
  78   1              _nop_();
  79   1              D18B20=0;
  80   1              TempDelay(80);   //delay 530 uS//80
  81   1              _nop_();
  82   1              D18B20=1;
  83   1              TempDelay(14);   //delay 100 uS//14
  84   1              _nop_();
  85   1              _nop_();
  86   1              _nop_();
  87   1              
  88   1              if(D18B20==0)
  89   1                      flag = 1;   //detect 1820 success!
  90   1              else
  91   1                      flag = 0;    //detect 1820 fail!
  92   1              TempDelay(20);       //20
  93   1              _nop_();
  94   1              _nop_();
  95   1              D18B20 = 1;
  96   1      }
  97          
  98          /************************************************************
  99          *Function:Ïò18B20Ð´ÈëÒ»¸ö×Ö½Ú
 100          *parameter:
 101          *Return:
 102          *Modify:
 103          *************************************************************/
 104          void WriteByte (unsigned char idata wr)  //µ¥×Ö½ÚÐ´Èë
 105          {
 106   1              unsigned char idata i;
 107   1              for (i=0;i<8;i++)
 108   1              {
 109   2                      D18B20 = 0;
 110   2                      _nop_();
 111   2                      D18B20=wr&0x01;
 112   2                      TempDelay(3);   //delay 45 uS //5
 113   2                      _nop_();
 114   2                      _nop_();
C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 3   

 115   2                      D18B20=1;
 116   2                      wr >>= 1;
 117   2              }
 118   1      }
 119          
 120          /************************************************************
 121          *Function:¶Á18B20µÄÒ»¸ö×Ö½Ú
 122          *parameter:
 123          *Return:
 124          *Modify:
 125          *************************************************************/
 126          unsigned char ReadByte (void)     //¶ÁÈ¡µ¥×Ö½Ú
 127          {
 128   1              unsigned char idata i,u=0;
 129   1              for(i=0;i<8;i++)
 130   1              {
 131   2                      D18B20 = 0;
 132   2                      u >>= 1;
 133   2                      D18B20 = 1;
 134   2                      if(D18B20==1)
 135   2                      u |= 0x80;
 136   2                      TempDelay (2);
 137   2                      _nop_();
 138   2              }
 139   1              return(u);
 140   1      }
 141          
 142          /************************************************************
 143          *Function:¶Á18B20
 144          *parameter:
 145          *Return:
 146          *Modify:
 147          *************************************************************/
 148          void read_bytes (unsigned char idata j)
 149          {
 150   1               unsigned char idata i;
 151   1               for(i=0;i<j;i++)
 152   1               {
 153   2                        *p = ReadByte();
 154   2                        p++;
 155   2               }
 156   1      }
 157          
 158          /************************************************************
 159          *Function:CRCÐ£Ñé
 160          *parameter:
 161          *Return:
 162          *Modify:
 163          *************************************************************/
 164          unsigned char CRC (unsigned char j)
 165          {
 166   1              unsigned char idata i,crc_data=0;
 167   1              for(i=0;i<j;i++)  //²é±íÐ£Ñé
 168   1              crc_data = CrcTable[crc_data^temp_buff[i]];
 169   1          return (crc_data);
 170   1      }
 171          
 172          /************************************************************
 173          *Function:¶ÁÈ¡ÎÂ¶È
 174          *parameter:
 175          *Return:
 176          *Modify:
C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 4   

 177          *************************************************************/
 178          void GemTemp (void)
 179          {
 180   1         read_bytes (9);
 181   1         if (CRC(9)==0) //Ð£ÑéÕýÈ·
 182   1         {
 183   2                  Temperature = temp_buff[1]*0x100 + temp_buff[0];
 184   2      //          Temperature *= 0.625;
 185   2                      Temperature /= 16; //È¡³öÎÂ¶ÈÕûÊýÎ»
 186   2                      Decimal=Temperature%16;
 187   2                      TempDelay(1);
 188   2          }
 189   1      }
 190          
 191          /************************************************************
 192          *Function:ÄÚ²¿ÅäÖÃ
 193          *parameter:
 194          *Return:
 195          *Modify:
 196          *************************************************************/
 197          void Config18b20 (void)  //ÖØÐÂÅäÖÃ±¨¾¯ÏÞ¶¨ÖµºÍ·Ö±æÂÊ
 198          {
 199   1           Init18b20();
 200   1           WriteByte(0xcc);  //skip rom
 201   1           WriteByte(0x4e);  //write scratchpad
 202   1           WriteByte(0x19);  //ÉÏÏÞ
 203   1           WriteByte(0x1a);  //ÏÂÏÞ
 204   1           WriteByte(0x7f);     //set 12 bit (0.125)
 205   1           Init18b20();
 206   1           WriteByte(0xcc);  //skip rom
 207   1           WriteByte(0x48);  //±£´æÉè¶¨Öµ
 208   1           Init18b20();
 209   1           WriteByte(0xcc);  //skip rom
 210   1           WriteByte(0xb8);  //»Øµ÷Éè¶¨Öµ
 211   1      }
 212          
 213          /************************************************************
 214          *Function:¶Á18B20ID
 215          *parameter:
 216          *Return:
 217          *Modify:
 218          *************************************************************/
 219          void ReadID (void)//¶ÁÈ¡Æ÷¼þ id
 220          {
 221   1              Init18b20();
 222   1              WriteByte(0x33);  //read rom
 223   1              read_bytes(8);
 224   1      }
 225          
 226          /************************************************************
 227          *Function:18B20IDÈ«´¦Àí
 228          *parameter:
 229          *Return:
 230          *Modify:
 231          *************************************************************/
 232          void TemperatuerResult(void)
 233          {
 234   1              p = id_buff;
 235   1              ReadID();
 236   1              Config18b20();
 237   1              Init18b20 ();
 238   1              WriteByte(0xcc);   //skip rom
C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 5   

 239   1              WriteByte(0x44);   //Temperature convert
 240   1      
 241   1              Init18b20 ();
 242   1              WriteByte(0xcc);   //skip rom
 243   1              WriteByte(0xbe);   //read Temperature
 244   1              p = temp_buff;
 245   1              GemTemp();
 246   1      }
 247           //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡
             -ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 248           //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ªÒÔÉÏÊÇDS18B20µÄ¸÷Ïî²Ù×÷¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 249           //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡
             -ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 250           //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡
             -ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 251          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ªÒÔÏÂÊÇÖ÷º¯ÊýºÍ´®¿Ú³£¹æ²Ù×÷£¬ºÍ¸÷ÀàÊý¾Ý×ª»»
             -º¯Êý¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 252          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 253          
 254           //ÑÓÊ±³ÌÐò
 255          void delay(unsigned int i)
 256          {
 257   1          char j;
 258   1          for(i; i > 0; i--)
 259   1              for(j = 200; j > 0; j--);
 260   1      }
 261          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 262          void system_Ini()
 263          {
 264   1              SCON = 0x50;      //REN=1ÔÊÐí´®ÐÐ½ÓÊÜ×´Ì¬£¬´®¿Ú¹¤×÷Ä£Ê½1                   
 265   1                  TMOD|= 0x20;      //¶¨Ê±Æ÷¹¤×÷·½Ê½2                    
 266   1                      PCON|= 0x80;                                                          
 267   1                      TH1 = 0xFA;               //baud*2  /* reload value 9600¡¢Êý¾ÝÎ»8¡¢Í£Ö¹Î»1¡£Ð§ÑéÎ»ÎÞ (11.0592) 
 268   1              TL1 = 0xFA;         
 269   1                      TR1  = 1;                                                             
 270   1                      ES   = 1;        //¿ª´®¿ÚÖÐ¶Ï                  
 271   1                      EA   = 1;        // ¿ª×ÜÖÐ¶Ï       
 272   1      }
 273          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 274          void UART_Send_Byte(unsigned char mydata)       // ·¢ËÍÒ»¸ö×Ö½Ú
 275          {
 276   1       ES=0;
 277   1       TI=0;
 278   1       SBUF=mydata;
 279   1       while(!TI);
 280   1       TI=0;
 281   1       ES=1;
 282   1      }
 283          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 284          void UART_Send_Str(char *s)       //·¢ËÍÎÄ±¾´®
 285          {
 286   1       int i=0;
 287   1       while(s[i]!=0)
 288   1       {
 289   2              UART_Send_Byte(s[i]);
 290   2              i++;
 291   2       }
C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 6   

 292   1       
 293   1      }
 294          
 295          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 296          void UART_Send_END(void)   //·¢ËÍ½áÊø·û
 297          {
 298   1               UART_Send_Byte(0xFF);
 299   1               UART_Send_Byte(0xFF);
 300   1               UART_Send_Byte(0xFF);
 301   1      }
 302          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 303          void Integer_character_Send(unsigned char N) //½«ÎÂ¶ÈÊýÖµ·Ö½âÎª ¸öÎ»£¬Ê®Î»£¬°ÙÎ»  £¬²¢×ª»»Îª×Ö·û·¢ËÍ³öÈ¥
 304          { unsigned char g,s,b,l;
 305   1        l=N;
 306   1        b=l/100; //·Ö½â»ñµÃ°ÙÎ»Êý¾Ý Èç 117/100=1.17  ×Ô¶¯ÉáÈ¥Ð¡ÊýÎ»µÃ  1
 307   1        l=l%100; //È¡ÓàÊý ÉáÈ¥ÕûÊýÎ» µÃ 17
 308   1        s=l/10;  //17/10=1.7
 309   1        l=l%10;  //µÃ 7
 310   1        g=l;     //  7
 311   1      
 312   1         //  48,49,50,51,52,53,54,55,56,57  ×Ö·û×Ö½Ú±í×Ö·û0-9µÄ×Ö½ÚÂë 
 313   1        if(b==0) // °ÙÎ»Îª 0 ¾Í²»·¢ËÍÁË
 314   1         {
 315   2              if(s==0); // Ê®Î»Îª 0 ¾Í²»·¢ËÍÁË
 316   2              else UART_Send_Byte(s+48);
 317   2         }
 318   1              else { 
 319   2              UART_Send_Byte(b+48);  // ×Ö½Ú48=×Ö·û0   Èç¹û°ÙÎ»ÊÇ1   1+48=49   ¼´=×Ö·û ¡°1¡±
 320   2              if(s==0); // Ê®Î»Îª 0 ¾Í²»·¢ËÍÁË
 321   2              else UART_Send_Byte(s+48);
 322   2          }
 323   1      
 324   1         UART_Send_Byte(g+48);   //¸öÎ»²»¹ÜÊÇ²»ÊÇ0  ¶¼·¢ËÍ
 325   1      }
 326          
 327          //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 328            main()
 329            {
 330   1      
 331   1       unsigned int ASC=0; 
 332   1       system_Ini(); //ÉèÖÃÍ¨Ñ¶´®¿Ú
 333   1      
 334   1          while(1)
 335   1         {             
 336   2               ASC++;
 337   2               delay(500);
 338   2      
 339   2               if(ASC>=110)   //ÑÓÊ±Ò»¶ÎÊ±¼äºó¶ÁÈ¡18B20ÎÂ¶ÈÖµ
 340   2               {
 341   3                ASC=0;
 342   3                TemperatuerResult();//¶ÁÎÂ¶È
 343   3                delay(500);
 344   3                //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡
             -ª¸øÎÄ±¾¿Ø¼þ¸³Öµ
 345   3                
 346   3                
 347   3      
 348   3      
 349   3                if(Temperature<121)  //DS18B20 ×î´ó²âÎÂÎª125¶È  ËùÒÔÏÞÖÆÖ»ÏÔÊ¾120ÒÔÏÂµÄÎÂ¶È 
C51 COMPILER V9.01   1820                                                                  08/20/2015 09:44:37 PAGE 7   

 350   3                 {
 351   4                                                                 
 352   4                UART_Send_Str("t0.txt="); //·¢ËÍ×Ö·û                                                                                                                                  
 353   4                UART_Send_Byte(34);  //·¢ËÍÒ»¸ö×Ö½Ú £¬Îª ÒýºÅ  ,,ÎÄ±¾¿Ø¼þµÄÊôÐÔTXTÎª×Ö·ûÐÍ£¬£¬£¬ËùÒÔÐèÒª·¢ËÍÒýºÅ
 354   4      
 355   4      
 356   4                Integer_character_Send(Temperature);// °ÑÕûÊýÊý¾Ý ½âÎöµÃµ½Ã¿ Ò»Î»Êý£¬×ªÎª×Ö·ûÂë ºó ·¢ËÍ³öÈ¥
 357   4                UART_Send_Byte(46);  //·¢ËÍÐ¡Êýµã
 358   4                Integer_character_Send(Decimal);      //·¢ËÍÐ¡ÊýÎ»£¬£¬£¬×¢£¬DS18B20 µÄÎó²îÎª0.5¶È£¬ËùÒÔÏÔÊ¾Ð¡ÊýÎ»Ã»Ê²Ã´±ØÒªÁ
             -Ë£¬×ÔÎÒ°²Î¿Ò»ÏÂ
 359   4      
 360   4      
 361   4                UART_Send_Byte(34);  //·¢ËÍÒ»¸ö×Ö½Ú £¬Îª ÒýºÅ 
 362   4                UART_Send_END();   //·¢ËÍ½áÊø·û
 363   4      
 364   4                 }
 365   3      
 366   3      
 367   3                 //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
             -¡ª¸øÎÄ±¾¿Ø¼þ¸³Öµ
 368   3                 if(Temperature<100)//½ø¶ÈÌõ¿Ø¼þµÄÊýÖµÈç¹û³¬¹ý100¾Í»áÎÞÐ§,ËùÒÔ´óÓÚ100¾Í²»¸øËû¸³ÖµÁË
 369   3                 {
 370   4                 delay(10);
 371   4                 UART_Send_Str("j0.val=");
 372   4                 Integer_character_Send(Temperature);  //½ø¶ÈÌõvalÊôÐÔÊÇÕûÊýÐÍ£¬£¬£¬ËùÒÔ²»ÐèÒª·¢ËÍÒýºÅ
 373   4                 UART_Send_END();
 374   4      
 375   4                 }
 376   3      
 377   3      
 378   3      
 379   3      
 380   3               }              
 381   2          }  
 382   1        }
 383           //¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡
             -ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª¡ª
 384          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    655    ----
   CONSTANT SIZE    =    272    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3       5
   IDATA SIZE       =     20       6
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
